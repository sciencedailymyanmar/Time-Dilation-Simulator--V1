<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Dilation Simulator - Science Daily (WebGL Edition)</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <style>
        :root {
            --primary-color: #00f2ff; /* Neon Cyan */
            --secondary-color: #ff0055; /* Neon Pink */
            --earth-color: #4ade80; /* Neon Green */
            --bg-dark: #020617;
            --glass-bg: rgba(15, 23, 42, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-light: #e2e8f0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-dark);
            /* Fallback background if WebGL fails to cover */
            background: radial-gradient(ellipse at center, #1b2735 0%, var(--bg-dark) 100%); 
            color: var(--text-light);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* WebGL Background Container */
        #webgl-bg-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; /* Place behind everything */
            pointer-events: none;
        }

        /* --- Typography & Header --- */
        h1, h2, .brand-header { font-family: 'Orbitron', sans-serif; letter-spacing: 2px; }
        
        .brand-header {
            color: var(--primary-color);
            font-size: 1rem;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 242, 255, 0.5);
            position: relative; z-index: 10;
        }

        h1 {
            background: linear-gradient(to right, var(--text-light), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center; margin: 0 0 10px 0; font-size: 2.5rem;
            position: relative; z-index: 10;
        }

        .subtitle { text-align: center; color: #94a3b8; max-width: 600px; margin-bottom: 30px; line-height: 1.6; position: relative; z-index: 10; }

        /* --- Glassmorphism Cards --- */
        .container { display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; width: 100%; max-width: 900px; position: relative; z-index: 10; }

        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px 20px;
            flex: 1; min-width: 300px;
            text-align: center;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            transition: all 0.3s ease;
            position: relative; overflow: hidden;
        }

        .card.earth { border-bottom: 3px solid var(--earth-color); }
        .card.space { border-bottom: 3px solid var(--secondary-color); }
        
        /* Containers for 3D Scenes inside cards */
        .webgl-container {
            width: 100%;
            height: 200px; /* Fixed height for 3D view */
            margin-bottom: 15px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        #earth-scene-container { background: rgba(0,0,0,0.2); }
        #space-scene-container { background: rgba(0,0,0,0.2); }

        .timer { font-family: 'Orbitron', monospace; font-size: 3rem; font-weight: 700; margin: 10px 0; text-shadow: 0 0 15px rgba(255,255,255,0.3); }
        .label { color: var(--primary-color); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; font-weight: bold; }

        /* --- Controls Section --- */
        .controls {
            background: var(--glass-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border); padding: 30px;
            border-radius: 20px; width: 100%; max-width: 900px; margin-top: 30px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37); position: relative; z-index: 10;
        }

        /* --- Custom Neon Slider --- */
        input[type=range] {
            -webkit-appearance: none; width: 100%; height: 12px; background: rgba(255,255,255,0.1);
            border-radius: 10px; margin: 30px 0; outline: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 25px; height: 25px;
            background: var(--primary-color); border-radius: 50%; cursor: pointer;
            box-shadow: 0 0 15px var(--primary-color), 0 0 30px var(--primary-color);
            transition: transform 0.2s;
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); }

        .speed-display { display: flex; justify-content: space-between; align-items: center; font-family: 'Orbitron', sans-serif; }
        .speed-value { font-size: 1.4rem; color: var(--primary-color); text-shadow: 0 0 10px var(--primary-color); }

        /* --- Modern Buttons --- */
        .btn-group { display: flex; gap: 15px; justify-content: center; margin-top: 30px; flex-wrap: wrap; }
        button {
            padding: 12px 30px; border: none; border-radius: 30px; cursor: pointer;
            font-weight: bold; font-family: 'Orbitron', sans-serif; letter-spacing: 1px;
            transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .btn-start { background: linear-gradient(45deg, var(--primary-color), #005bea); color: #000; box-shadow: 0 0 20px rgba(0, 242, 255, 0.4); }
        .btn-stop { background: linear-gradient(45deg, var(--secondary-color), #ff5f6d); color: white; box-shadow: 0 0 20px rgba(255, 0, 85, 0.4); }
        .btn-reset { background: rgba(255, 255, 255, 0.1); color: white; border: 1px solid rgba(255,255,255,0.2); }
        button:hover { transform: translateY(-3px); box-shadow: 0 10px 20px -10px rgba(255,255,255,0.5); }
        button:active { transform: translateY(1px); }

        .fact-box { margin-top: 25px; padding: 20px; background: rgba(0, 242, 255, 0.05); border-radius: 10px; border-left: 4px solid var(--primary-color); font-size: 1rem; }

        /* --- User Guide Collapsible --- */
        .guide-details { width: 100%; max-width: 900px; margin-bottom: 20px; z-index: 10; }
        .guide-summary {
            background: var(--glass-bg); backdrop-filter: blur(15px); color: var(--primary-color);
            padding: 15px 25px; border-radius: 15px; cursor: pointer; font-family: 'Orbitron', sans-serif;
            border: 1px solid var(--glass-border); list-style: none; display: flex; justify-content: space-between; align-items: center;
        }
        .guide-summary::after { content: 'â–¼'; font-size: 0.8rem; transition: transform 0.3s; }
        details[open] .guide-summary::after { transform: rotate(180deg); }
        .guide-content {
            background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(15px); padding: 20px 30px;
            border-radius: 0 0 15px 15px; border: 1px solid var(--glass-border); border-top: none; margin-top: -5px;
        }
        .guide-content ol { padding-left: 20px; line-height: 1.8; }
        .guide-content li::marker { color: var(--primary-color); font-weight: bold; }

        footer { margin-top: 40px; color: #64748b; font-size: 0.9rem; z-index: 10; }

        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .timer { font-size: 2.2rem; }
            .btn-group { flex-direction: column; width: 100%; }
            button { width: 100%; }
            .webgl-container { height: 150px; }
        }
    </style>
</head>
<body>
    <div id="webgl-bg-container"></div>

    <div class="brand-header">Science Daily á€™á€¾ á€á€„á€ºá€†á€€á€ºá€á€Šá€º (WebGL Edition)</div>
    <h1>Time Dilation Simulator</h1>
    <p class="subtitle">
        á€¡á€­á€¯á€„á€ºá€¸á€…á€á€­á€¯á€„á€ºá€¸á á€”á€¾á€­á€¯á€„á€ºá€¸á€›á€á€®á€¡á€­á€¯á€›á€®á€¡á€› á€¡á€œá€»á€„á€ºá€™á€¼á€”á€ºá€œá€± á€¡á€á€»á€­á€”á€ºá€”á€¾á€±á€¸á€œá€± á€–á€¼á€…á€ºá€•á€¯á€¶á€€á€­á€¯ á€…á€½á€™á€ºá€¸á€†á€±á€¬á€„á€ºá€›á€Šá€ºá€™á€¼á€„á€·á€º 3D á€›á€¯á€•á€ºá€‘á€½á€€á€ºá€™á€»á€¬á€¸á€–á€¼á€„á€·á€º á€œá€€á€ºá€á€½á€±á€·á€…á€™á€ºá€¸á€á€•á€ºá€á€”á€ºá€¸á‹
    </p>

    <details class="guide-details">
        <summary class="guide-summary">ğŸ”° á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€•á€¯á€¶ á€œá€™á€ºá€¸á€Šá€½á€¾á€”á€º (How to Use)</summary>
        <div class="guide-content">
            <ol>
                <li>á€¡á€±á€¬á€€á€ºá€†á€¯á€¶á€¸á€›á€¾á€­ <b>"Slider (á€‘á€­á€”á€ºá€¸á€á€»á€¯á€•á€ºá€á€¶)"</b> á€€á€­á€¯ á€†á€½á€²á á€¡á€¬á€€á€¬á€á€šá€¬á€‰á€ºá á€¡á€™á€¼á€”á€ºá€”á€¾á€¯á€”á€ºá€¸á€€á€­á€¯ á€á€á€ºá€™á€¾á€á€ºá€•á€«á‹ (á€Šá€¬á€˜á€€á€ºá€›á€¾á€­ 3D Warp Effect á€™á€¼á€”á€ºá€œá€¬á€á€Šá€ºá€€á€­á€¯ á€á€á€­á€•á€¼á€¯á€•á€«á‹)</li>
                <li><b>"á€…á€á€„á€ºá€™á€šá€º (Start)"</b> á€á€œá€¯á€á€ºá€€á€­á€¯ á€”á€¾á€­á€•á€ºá€•á€«á‹</li>
                <li>á€˜á€šá€ºá€˜á€€á€º (á€€á€™á€¹á€˜á€¬) á€”á€¾á€„á€·á€º á€Šá€¬á€˜á€€á€º (á€¡á€¬á€€á€¬á€) á€á€­á€¯á€·á€›á€¾á€­ á€”á€¬á€›á€®á€™á€»á€¬á€¸á á€€á€¯á€”á€ºá€†á€¯á€¶á€¸á€™á€¾á€¯á€”á€¾á€¯á€”á€ºá€¸ á€™á€á€°á€Šá€®á€•á€¯á€¶á€€á€­á€¯ á€œá€±á€·á€œá€¬á€•á€«á‹</li>
            </ol>
        </div>
    </details>

    <div class="container">
        <div class="card earth">
            <div id="earth-scene-container" class="webgl-container"></div>
            <div class="label">á€€á€™á€¹á€˜á€¬á€•á€±á€«á€ºá€›á€¾á€­ á€Šá€®</div>
            <div class="timer" id="earthTime">0.00</div>
            <div class="label">á€€á€¯á€”á€ºá€†á€¯á€¶á€¸á€á€½á€¬á€¸á€á€±á€¬ á€”á€¾á€…á€º (Years)</div>
            <p style="font-size: 0.85rem; color: #94a3b8; margin-top: 15px;">á€á€¬á€™á€”á€ºá€¡á€á€»á€­á€”á€ºá€¡á€á€­á€¯á€„á€ºá€¸ á€”á€±á€‘á€­á€¯á€„á€ºá€”á€±á€á€°</p>
        </div>

        <div class="card space">
             <div id="space-scene-container" class="webgl-container"></div>
            <div class="label">á€¡á€¬á€€á€¬á€á€šá€¬á€‰á€ºá€•á€±á€«á€ºá€›á€¾á€­ á€¡á€…á€ºá€€á€­á€¯</div>
            <div class="timer" id="spaceTime">0.00</div>
            <div class="label">á€€á€¯á€”á€ºá€†á€¯á€¶á€¸á€á€½á€¬á€¸á€á€±á€¬ á€”á€¾á€…á€º (Years)</div>
            <p style="font-size: 0.85rem; color: #94a3b8; margin-top: 15px;">á€¡á€œá€„á€ºá€¸á€¡á€œá€»á€„á€ºá€”á€®á€¸á€•á€«á€¸ á€á€›á€®á€¸á€”á€¾á€„á€ºá€”á€±á€á€°</p>
        </div>
    </div>

    <div class="controls">
        <div class="speed-display">
            <span>ğŸš€ á€šá€¬á€‰á€ºá á€¡á€œá€»á€„á€º (Velocity):</span>
            <span class="speed-value" id="speedVal">0 % c (Light Speed)</span>
        </div>
        
        <input type="range" id="speedSlider" min="0" max="99.9" step="0.1" value="0">
        
        <div class="fact-box" id="explanation">
            á€¡á€œá€»á€„á€º á€% á€á€½á€„á€º á€¡á€á€»á€­á€”á€ºá€€á€½á€¬á€á€¼á€¬á€¸á€™á€¾á€¯ á€™á€›á€¾á€­á€•á€«á‹ Slider á€€á€­á€¯ á€†á€½á€²á€á€„á€ºá€•á€¼á€®á€¸ 3D Warp Effect á€€á€­á€¯ á€…á€™á€ºá€¸á€á€•á€ºá€€á€¼á€Šá€·á€ºá€•á€«á‹
        </div>

        <div class="btn-group">
            <button class="btn-start" onclick="startSimulation()">â–¶ á€…á€á€„á€ºá€™á€šá€º (Start)</button>
            <button class="btn-stop" onclick="stopSimulation()">â¸ á€›á€•á€ºá€™á€šá€º (Stop)</button>
            <button class="btn-reset" onclick="resetSimulation()">â†º á€¡á€…á€€á€•á€¼á€”á€ºá€á€½á€¬á€¸ (Reset)</button>
        </div>
    </div>

    <footer>
        Â© 2026 Time Dilation Visualization. Created by Science Daily with WebGL/Three.js.
    </footer>

    <script>
        // --- GLOBAL VARIABLES FOR SIMULATION ---
        let earthYears = 0;
        let spaceYears = 0;
        let isRunning = false;
        let lastTimestamp = 0;
        let currentSpeedPercent = 0; // To control 3D speed

        // DOM Elements
        const earthDisplay = document.getElementById('earthTime');
        const spaceDisplay = document.getElementById('spaceTime');
        const slider = document.getElementById('speedSlider');
        const speedValDisplay = document.getElementById('speedVal');
        const explanation = document.getElementById('explanation');

        // ==========================================
        // WEBGL / THREE.JS IMPLEMENTATION SECTION
        // ==========================================

        // --- SCENE 1: 3D EARTH (Rotating Wireframe Sphere) ---
        let earthScene, earthCamera, earthRenderer, earthMesh, earthWireframeBtn;
        
        function initEarthScene() {
            const container = document.getElementById('earth-scene-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            earthScene = new THREE.Scene();
            earthCamera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
            earthCamera.position.z = 5;

            earthRenderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            earthRenderer.setSize(width, height);
            container.appendChild(earthRenderer.domElement);

            // Earth Geometry (Neon Style)
            const geometry = new THREE.SphereGeometry(2, 32, 32);
            // Base material (dark blue/green)
            const material = new THREE.MeshBasicMaterial({ color: 0x001a33, transparent: true, opacity: 0.8 });
            earthMesh = new THREE.Mesh(geometry, material);
            
            // Wireframe overlay (neon green/cyan)
            const wireframeGeo = new THREE.WireframeGeometry(geometry);
            const wireframeMat = new THREE.LineBasicMaterial({ color: 0x4ade80, linewidth: 1 });
            earthWireframeBtn = new THREE.LineSegments(wireframeGeo, wireframeMat);
            earthMesh.add(earthWireframeBtn);

            earthScene.add(earthMesh);

            // Add some ambient light
            const ambientLight = new THREE.AmbientLight(0x404040);
            earthScene.add(ambientLight);
        }

        // --- SCENE 2: 3D SPACE WARP (Starfield + Ship) ---
        let spaceScene, spaceCamera, spaceRenderer, stars, shipMesh;
        let starGeo, starMat;
        let warpSpeed = 0; // Controlled by slider

        function initSpaceScene() {
            const container = document.getElementById('space-scene-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            spaceScene = new THREE.Scene();
            // Fog to make stars fade in distance
            spaceScene.fog = new THREE.FogExp2(0x020617, 0.002); 

            spaceCamera = new THREE.PerspectiveCamera(60, width / height, 1, 1000);
            spaceCamera.position.z = 1;
            spaceCamera.rotation.x = Math.PI/2; // Point camera upwards along Z axis

            spaceRenderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            spaceRenderer.setSize(width, height);
            container.appendChild(spaceRenderer.domElement);

            // --- The "Warp" Starfield ---
            starGeo = new THREE.BufferGeometry();
            const starVertices = [];
            for(let i=0; i<6000; i++) {
                let x = (Math.random() - 0.5) * 2000;
                let y = (Math.random() - 0.5) * 2000;
                let z = (Math.random() - 0.5) * 2000;
                starVertices.push(x, y, z);
            }
            starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
            
            starMat = new THREE.PointsMaterial({
                color: 0xffffff,
                size: 1.5,
                transparent: true
            });
            stars = new THREE.Points(starGeo, starMat);
            spaceScene.add(stars);

            // --- Simple 3D Ship Representation (Low Poly Cone) ---
            const shipGeo = new THREE.ConeGeometry(0.5, 2, 8);
            const shipMat = new THREE.MeshPhongMaterial({ color: 0xff0055, emissive: 0x330011, shininess: 100 });
            shipMesh = new THREE.Mesh(shipGeo, shipMat);
            shipMesh.rotation.x = Math.PI; // Point forward
            shipMesh.position.set(0, 50, 0); // Position in front of camera
            spaceScene.add(shipMesh);

             // Add lights for the ship
             const directionalLight = new THREE.DirectionalLight(0x00f2ff, 1);
             directionalLight.position.set(0, -1, 0);
             spaceScene.add(directionalLight);
        }

        // --- Main WebGL Animation Loop ---
        function animateWebGL() {
            requestAnimationFrame(animateWebGL);

            // Rotate Earth slowly
            if(earthMesh) {
                earthMesh.rotation.y += 0.002;
                earthWireframeBtn.rotation.y -= 0.001; // Counter rotation for cool effect
            }

            // Animate Space Warp based on Slider Value
            if(stars && starGeo) {
                const positions = starGeo.attributes.position.array;
                // Map slider percent (0-100) to warp speed (min 2, max 50)
                warpSpeed = 2 + (currentSpeedPercent / 100) * 48; 

                for(let i=0; i < positions.length; i+=3) {
                    // Move stars along Z axis towards camera
                    positions[i+1] -= warpSpeed; 
                    
                    // Reset star if it passes the camera
                    if (positions[i+1] < -200) {
                        positions[i+1] = 1000; 
                    }
                }
                starGeo.attributes.position.needsUpdate = true;

                // Make ship shake slightly at high speeds
                if(shipMesh && currentSpeedPercent > 50) {
                     shipMesh.position.x = (Math.random() - 0.5) * (currentSpeedPercent/500);
                } else if (shipMesh) {
                     shipMesh.position.x = 0;
                }

                // Change Star color based on speed (White -> Blue -> Cyan)
                if(currentSpeedPercent > 80) starMat.color.setHex(0x00f2ff);
                else if (currentSpeedPercent > 40) starMat.color.setHex(0xaaaaff);
                else starMat.color.setHex(0xffffff);
            }

            // Render scenes
            if(earthRenderer && earthScene && earthCamera) {
                earthRenderer.render(earthScene, earthCamera);
            }
            if(spaceRenderer && spaceScene && spaceCamera) {
                spaceRenderer.render(spaceScene, spaceCamera);
            }
        }

        // Handle Window Resize for WebGL
        window.addEventListener('resize', onWindowResize, false);
        function onWindowResize() {
            // Earth Resize
            const eContainer = document.getElementById('earth-scene-container');
            earthCamera.aspect = eContainer.clientWidth / eContainer.clientHeight;
            earthCamera.updateProjectionMatrix();
            earthRenderer.setSize(eContainer.clientWidth, eContainer.clientHeight);

            // Space Resize
            const sContainer = document.getElementById('space-scene-container');
            spaceCamera.aspect = sContainer.clientWidth / sContainer.clientHeight;
            spaceCamera.updateProjectionMatrix();
            spaceRenderer.setSize(sContainer.clientWidth, sContainer.clientHeight);
        }

        // Initialize WebGL Scenes
        initEarthScene();
        initSpaceScene();
        animateWebGL(); // Start the 3D rendering loop immediately

        // ==========================================
        // SIMULATION LOGIC SECTION (JS)
        // ==========================================

        slider.addEventListener('input', function() {
            currentSpeedPercent = this.value; // Update global speed for WebGL
            updateSpeedVisuals(this.value);
        });

        function updateSpeedVisuals(val) {
            speedValDisplay.innerText = val + " % c (Light Speed)";
            
            // Math Logic
            let v = val / 100;
            let dilationFactor = Math.sqrt(1 - (v * v));
            
            let msg = "";
            if (val == 0) {
                msg = "á€¡á€œá€»á€„á€º á€% á€á€½á€„á€º á€¡á€á€»á€­á€”á€ºá€€á€½á€¬á€á€¼á€¬á€¸á€™á€¾á€¯ á€™á€›á€¾á€­á€•á€«á‹ Slider á€€á€­á€¯ á€†á€½á€²á€á€„á€ºá€•á€¼á€®á€¸ 3D Warp Effect á€€á€­á€¯ á€…á€™á€ºá€¸á€á€•á€ºá€€á€¼á€Šá€·á€ºá€•á€«á‹";
            } else if (val < 50) {
                msg = "á€¡á€™á€¼á€”á€ºá€”á€¾á€¯á€”á€ºá€¸ á€…á€á€„á€º á€™á€¼á€„á€·á€ºá€á€€á€ºá€œá€¬á€•á€«á€•á€¼á€®á‹ á€Šá€¬á€˜á€€á€ºá€›á€¾á€­ á€€á€¼á€šá€ºá€™á€»á€¬á€¸á á€›á€½á€±á€·á€œá€»á€¬á€¸á€™á€¾á€¯á€€á€­á€¯ á€á€á€­á€•á€¼á€¯á€•á€«á‹";
            } else if (val > 99) {
                msg = `WARP SPEED! á€¡á€œá€„á€ºá€¸á€¡á€œá€»á€„á€ºá€”á€®á€¸á€•á€«á€¸á€–á€¼á€…á€ºá€œá€­á€¯á€· á€šá€¬á€‰á€ºá€•á€±á€«á€ºá€™á€¾á€¬ á€¡á€á€»á€­á€”á€ºá€›á€•á€ºá€á€”á€·á€ºá€œá€¯á€”á€®á€¸á€•á€«á€¸ á€–á€¼á€…á€ºá€”á€±á€•á€«á€•á€¼á€®á‹`;
            } else if (val > 90) {
                 msg = `á€á€­á€á€­á€á€¬á€á€¬ á€€á€½á€¬á€á€¼á€¬á€¸á€á€½á€¬á€¸á€•á€«á€•á€¼á€®! á€€á€™á€¹á€˜á€¬á€•á€±á€«á€ºá€€ á á€”á€¾á€…á€ºá€Ÿá€¬ á€šá€¬á€‰á€ºá€•á€±á€«á€ºá€™á€¾á€¬ ${(dilationFactor).toFixed(2)} á€”á€¾á€…á€º (á€œá€¡á€”á€Šá€ºá€¸á€„á€šá€º) á€á€¬ á€›á€¾á€­á€•á€«á€á€±á€¬á€·á€á€šá€ºá‹`;
            } else {
                msg = "á€¡á€™á€¼á€”á€ºá€”á€¾á€¯á€”á€ºá€¸ á€™á€¼á€„á€·á€ºá€™á€¬á€¸á€”á€±á€•á€«á€•á€¼á€®á‹ á€¡á€¬á€€á€¬á€á€šá€¬á€‰á€ºá€•á€±á€«á€ºá€€ á€”á€¬á€›á€®á€€ á€€á€™á€¹á€˜á€¬á€‘á€€á€º á€•á€­á€¯á€”á€¾á€±á€¸á€€á€½á€±á€¸á€…á€½á€¬ á€œá€Šá€ºá€•á€á€ºá€”á€±á€á€¬á€€á€­á€¯ á€á€½á€±á€·á€›á€•á€«á€œá€­á€™á€·á€ºá€™á€šá€ºá‹";
            }
            explanation.innerText = msg;
        }

        function startSimulation() {
            if (!isRunning) {
                isRunning = true;
                lastTimestamp = performance.now();
                requestAnimationFrame(simulationLoop);
            }
        }

        function stopSimulation() {
            isRunning = false;
        }

        function resetSimulation() {
            isRunning = false;
            earthYears = 0;
            spaceYears = 0;
            updateDisplay();
        }

        // This loop handles the math and timer updates separately from WebGL rendering
        function simulationLoop(timestamp) {
            if (!isRunning) return;

            const deltaTime = (timestamp - lastTimestamp) / 1000; // seconds
            lastTimestamp = timestamp;

            // Simulation Speed: 1 real second = 1 year on Earth
            const simulationRate = 1.0; 
            
            let earthDelta = deltaTime * simulationRate;
            earthYears += earthDelta;

            // t' = t * sqrt(1 - v^2/c^2)
            let v = slider.value / 100;
            let timeDilationFactor = Math.sqrt(1 - (v * v));
            
            spaceYears += (earthDelta * timeDilationFactor);

            updateDisplay();
            requestAnimationFrame(simulationLoop);
        }

        function updateDisplay() {
            earthDisplay.innerText = earthYears.toFixed(2);
            spaceDisplay.innerText = spaceYears.toFixed(2);
        }

        // Initialize UI
        updateSpeedVisuals(0);

    </script>
</body>
</html>
